{% extends "layout.html" %}

{% block fieldset %}
</br>
<fieldset>
    <legend id="legend">Visualization of the {{ scenario }} scenario</legend>
    <div id="mapid">
    <script src="sample-geojson.js" type="text/javascript"></script>
	<script src="https://npmcdn.com/leaflet@1.0.0-rc.2/dist/leaflet.js"></script>
	<script>

		var mymap = L.map('mapid').setView([51.505, -0.09], 13);

		L.tileLayer('https://api.tiles.mapbox.com/v4/{id}/{z}/{x}/{y}.png?access_token=pk.eyJ1IjoibWFwYm94IiwiYSI6ImNpandmbXliNDBjZWd2M2x6bDk3c2ZtOTkifQ._QA7i5Mpkd_m30IGElHziw', {
			attribution: 'Map data &copy; <a href="http://openstreetmap.org">OpenStreetMap</a> contributors, ' +
				'<a href="http://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, ' +
				'Imagery <a href="http://mapbox.com">Mapbox</a>',
			id: 'mapbox.streets'
		}).addTo(mymap);



		function onEachFeatureSpec(feature, layer) {
			var popupContent = "hey"
			layer.bindPopup(popupContent);
		};


        {% for i in ubl %}

		var ublox = {
		    "type": "Feature",
		    "geometry": {
		        "type": "Point",
		        "coordinates": [{{ i[0] }},{{ i[1] }}]
            }
        };

        L.geoJson(ublox, {style: {"color": "red"}, onEachFeature: function onEachFeatureUbl(feature, layer) {
			layer.bindPopup('Longitude : ' + {{ i[0] }} + '<br />Latitude : ' + {{ i[1] }} + '<br />Time (hhmmss.dd) : ' + '{{ i[2] }}' + '<a href="/main"><h3>More</h3></a>');
		}}).addTo(mymap);
        {% endfor %}



		var spectracom = {
		    "type": "Feature",
		    "geometry": {
		        "type": "LineString",
		        "coordinates": {{ spec }}
            }
        };

        L.geoJson(spectracom, {onEachFeature: onEachFeatureSpec}).addTo(mymap);

		mymap.fitBounds(L.geoJson(ublox).getBounds());


	</script>
    </div>
</fieldset>



{% endblock %}